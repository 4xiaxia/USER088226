<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ‘å®˜æ™ºèƒ½ä½“ - æŒ‰è®¾è®¡ç¨¿å¸ƒå±€</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-8px); }
        }
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px) scale(0.8);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }
        @keyframes slideInFromCorner {
            from {
                opacity: 0;
                transform: scale(0.3) rotate(10deg);
            }
            to {
                opacity: 1;
                transform: scale(1) rotate(0deg);
            }
        }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.8; }
        }

        .float { animation: float 4s ease-in-out infinite; }
        .pulse { animation: pulse 3s ease-in-out infinite; }
        .fade-in-up { animation: fadeInUp 0.8s ease-out forwards; }
        .slide-in-corner { animation: slideInFromCorner 0.8s ease-out forwards; }

        /* èŠå¤©çª—å£ - æŒ‰è®¾è®¡ç¨¿å±…ä¸­ï¼Œç§»åŠ¨ç«¯é€‚é… */
        .chat-window {
            position: fixed;
            bottom: 120px;
            left: 50%;
            transform: translateX(-50%);
            width: min(280px, calc(100vw - 40px));
            height: min(320px, calc(100vh - 300px));
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 25px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
            border: 1px solid rgba(16, 185, 129, 0.2);
            z-index: 1000;
            display: flex;
            flex-direction: column;
        }

        .chat-bubble-assistant {
            background: rgba(248, 250, 252, 0.95);
            color: #374151;
            border-radius: 18px 18px 18px 4px;
            padding: 10px 14px;
            margin: 6px 0;
            border: 1px solid rgba(16, 185, 129, 0.2);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            font-size: 13px;
            line-height: 1.4;
            max-width: 85%;
            align-self: flex-start;
        }
        
        .chat-bubble-user {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            border-radius: 18px 18px 4px 18px;
            padding: 10px 14px;
            margin: 6px 0;
            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
            font-size: 13px;
            line-height: 1.4;
            max-width: 85%;
            align-self: flex-end;
        }

        /* åŠŸèƒ½æ¨¡å— - æŒ‰è®¾è®¡ç¨¿å››è§’å¸ƒå±€ï¼Œç§»åŠ¨ç«¯é€‚é… */
        .feature-module {
            position: fixed;
            width: min(100px, 18vw);
            height: min(100px, 18vw);
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 8px;
            box-shadow: 0 12px 32px rgba(0, 0, 0, 0.15);
            border: 1px solid rgba(16, 185, 129, 0.2);
            cursor: pointer;
            transition: all 0.3s ease;
            opacity: 0;
            z-index: 999;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .feature-module:hover {
            transform: translateY(-4px) scale(1.05);
            box-shadow: 0 16px 40px rgba(16, 185, 129, 0.25);
        }

        .feature-module.show {
            opacity: 1;
        }

        /* æ‘å®˜å¤´åƒ - æŒ‰è®¾è®¡ç¨¿é¡¶éƒ¨å±…ä¸­ */
        .village-chief {
            position: fixed;
            top: 80px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 1001;
        }

        /* è¾“å…¥åŒºåŸŸ - æŒ‰è®¾è®¡ç¨¿åº•éƒ¨ï¼Œç§»åŠ¨ç«¯é€‚é… */
        .input-area {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            width: min(300px, calc(100vw - 40px));
            z-index: 1000;
        }

        /* èƒŒæ™¯æ¸å˜ - ä¿æŒæˆ‘çš„é…è‰² */
        .bg-custom {
            background: linear-gradient(135deg, #ecfdf5 0%, #ffffff 50%, #f0fdfa 100%);
        }
    </style>
</head>
<body class="bg-custom min-h-screen overflow-hidden">

    <!-- ç§»åŠ¨ç«¯å®¹å™¨çº¦æŸ -->
    <div class="max-w-sm mx-auto min-h-screen relative">

    <!-- èƒŒæ™¯è£…é¥° -->
    <div class="absolute inset-0 overflow-hidden pointer-events-none">
        <div class="absolute top-20 left-10 w-20 h-20 bg-emerald-100 rounded-full opacity-20 float"></div>
        <div class="absolute bottom-32 right-16 w-16 h-16 bg-teal-100 rounded-full opacity-30 float" style="animation-delay: 1s"></div>
        <div class="absolute top-1/2 left-1/4 w-12 h-12 bg-green-100 rounded-full opacity-15 float" style="animation-delay: 2s"></div>
    </div>

    <!-- æ‘å®˜å¤´åƒåŒºåŸŸ - é¡¶éƒ¨å±…ä¸­ -->
    <div class="village-chief" id="villageChief">
        <div class="relative">
            <div class="w-24 h-24 bg-gradient-to-br from-emerald-400 to-teal-500 rounded-full p-1 shadow-xl pulse">
                <div class="w-full h-full bg-white rounded-full p-1">
                    <video
                        src="https://cdn.jsdelivr.net/gh/your-repo/mp4/gif.mp4"
                        class="w-full h-full rounded-full object-cover"
                        muted
                        loop
                        playsinline
                        autoplay
                        preload="auto"
                        onerror="this.parentElement.innerHTML='<div class=\"w-full h-full bg-emerald-100 rounded-full flex items-center justify-center\"><span class=\"text-2xl\">ğŸ‘¨â€ğŸ’¼</span></div>'"
                    ></video>
                </div>
            </div>
            <!-- åœ¨çº¿çŠ¶æ€ -->
            <div class="absolute -bottom-1 -right-1 w-6 h-6 bg-green-500 rounded-full border-2 border-white flex items-center justify-center">
                <div class="w-2 h-2 bg-white rounded-full pulse"></div>
            </div>
        </div>
        <!-- æ‘å®˜åå­— -->
        <div class="text-center mt-2">
            <h3 class="text-lg font-bold text-gray-800">Aå”æ‘å®˜</h3>
            <p class="text-xs text-emerald-600">æ­£åœ¨ä¸ºæ‚¨ä»‹ç»...</p>
        </div>
    </div>

    <!-- èŠå¤©çª—å£ - å±…ä¸­ -->
    <div class="chat-window" id="chatWindow">
        <!-- èŠå¤©å†…å®¹åŒºåŸŸ -->
        <div class="p-4 h-full overflow-y-auto" id="chatContent">
            <!-- æ¬¢è¿æ¶ˆæ¯ä¼šåŠ¨æ€æ·»åŠ  -->
        </div>
    </div>

    <!-- åŠŸèƒ½æ¨¡å— - å·¦ä¸Šè§’ï¼šçº¢è‰²ä¹‹æ—… -->
        <div class="feature-module" id="redTourModule" style="top: min(200px, 25vh); left: min(30px, 5vw);">
            <div class="text-center">
                <div class="text-xl mb-1">ğŸ›ï¸</div>
                <h4 class="text-xs font-bold text-gray-800 mb-1">çº¢è‰²ä¹‹æ—…</h4>
                <p class="text-xs text-gray-600">é©å‘½å†å²</p>
            </div>
        </div>

        <!-- åŠŸèƒ½æ¨¡å— - å³ä¸Šè§’ï¼šä¼´ä½ æ¸¸ä¸œé‡Œ -->
        <div class="feature-module" id="tourModule" style="top: min(200px, 25vh); right: min(30px, 5vw);">
            <div class="text-center">
                <div class="text-xl mb-1">ğŸŒ¿</div>
                <h4 class="text-xs font-bold text-gray-800 mb-1">ä¼´ä½ æ¸¸ä¸œé‡Œ</h4>
                <p class="text-xs text-gray-600">ç²¾é€‰è·¯çº¿</p>
            </div>
        </div>

        <!-- åŠŸèƒ½æ¨¡å— - å·¦ä¸‹è§’ï¼šèµ°è¿›ä¸œé‡Œ -->
        <div class="feature-module" id="historyModule" style="bottom: min(200px, 25vh); left: min(30px, 5vw);">
            <div class="text-center">
                <div class="text-xl mb-1">ğŸ“š</div>
                <h4 class="text-xs font-bold text-gray-800 mb-1">èµ°è¿›ä¸œé‡Œ</h4>
                <p class="text-xs text-gray-600">æ‘å²æ–‡åŒ–</p>
            </div>
        </div>

    <!-- è¾“å…¥åŒºåŸŸ - åº•éƒ¨ä¸­å¤® -->
    <div class="input-area" id="inputArea">
        <div class="bg-white rounded-full shadow-lg border border-emerald-200 flex items-center px-4 py-2">
            <input 
                type="text" 
                id="messageInput" 
                placeholder="è¯¢é—®æ‘å®˜..." 
                class="flex-1 outline-none text-sm bg-transparent"
                maxlength="100"
            >
            <button 
                id="sendBtn" 
                class="ml-2 w-8 h-8 bg-emerald-500 text-white rounded-full flex items-center justify-center hover:bg-emerald-600 transition-colors"
            >
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8"></path>
                </svg>
            </button>
        </div>
    </div>

    </div>

    <script>
        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            // æ˜¾ç¤ºåŠŸèƒ½æ¨¡å—åŠ¨ç”»
            setTimeout(() => {
                document.querySelectorAll('.feature-module').forEach((el, index) => {
                    setTimeout(() => {
                        el.classList.add('show');
                    }, index * 200);
                });
            }, 500);

            // åˆå§‹åŒ–èŠå¤©çª—å£
            initChatWindow();
            
            // ç»‘å®šåŠŸèƒ½æ¨¡å—ç‚¹å‡»äº‹ä»¶
            bindFeatureModuleEvents();
            
            // ç»‘å®šè¾“å…¥åŒºåŸŸäº‹ä»¶
            bindInputEvents();
        });

        // åˆå§‹åŒ–èŠå¤©çª—å£
        function initChatWindow() {
            const chatContent = document.getElementById('chatContent');
            if (!chatContent) return;
            
            const welcomeMessage = document.createElement('div');
            welcomeMessage.className = 'chat-bubble-assistant';
            welcomeMessage.innerHTML = 'æ‚¨å¥½ï¼æˆ‘æ˜¯Aå”æ‘å®˜ï¼Œå¾ˆé«˜å…´ä¸ºæ‚¨ä»‹ç»ä¸œé‡Œæ‘çš„å†å²æ–‡åŒ–å’Œæ—…æ¸¸èµ„æºã€‚è¯·é—®æ‚¨æƒ³äº†è§£ä»€ä¹ˆå‘¢ï¼Ÿ';
            chatContent.appendChild(welcomeMessage);
        }

        // ç»‘å®šåŠŸèƒ½æ¨¡å—ç‚¹å‡»äº‹ä»¶
        function bindFeatureModuleEvents() {
            const modules = {
                'redTourModule': 'çº¢è‰²ä¹‹æ—…',
                'tourModule': 'ä¼´ä½ æ¸¸ä¸œé‡Œ',
                'historyModule': 'èµ°è¿›ä¸œé‡Œ',
                'newsModule': 'æ‘å­åŠ¨æ€'
            };

            Object.keys(modules).forEach(moduleId => {
                const module = document.getElementById(moduleId);
                if (module) {
                    module.addEventListener('click', function() {
                        handleModuleClick(modules[moduleId]);
                    });
                }
            });
        }

        // å¤„ç†æ¨¡å—ç‚¹å‡»äº‹ä»¶
        function handleModuleClick(moduleName) {
            const chatContent = document.getElementById('chatContent');
            if (!chatContent) return;
            
            // å®šä¹‰æ¯ä¸ªæ¨¡å—å¯¹åº”çš„é¡µé¢URL
            const pageMap = {
                'çº¢è‰²ä¹‹æ—…': 'red-tour.html',
                'ä¼´ä½ æ¸¸ä¸œé‡Œ': 'tour-guide.html',
                'èµ°è¿›ä¸œé‡Œ': 'village-intro.html',
                'æ‘å­åŠ¨æ€': 'news.html'
            };
            
            // æ˜¾ç¤ºæç¤ºæ¶ˆæ¯
            const message = document.createElement('div');
            message.className = 'chat-bubble-assistant';
            message.innerHTML = `æ­£åœ¨ä¸ºæ‚¨è·³è½¬åˆ°"${moduleName}"é¡µé¢...`;
            chatContent.appendChild(message);
            chatContent.scrollTop = chatContent.scrollHeight;
            
            // 1ç§’åè·³è½¬åˆ°å¯¹åº”é¡µé¢
            setTimeout(() => {
                const pageUrl = pageMap[moduleName] || 'index.html';
                window.location.href = pageUrl;
            }, 1000);
        }

        // è·å–æ¨¡å—å†…å®¹
        function getModuleContent(moduleName) {
            const pageMap = {
                'çº¢è‰²ä¹‹æ—…': { 
                    content: 'ä¸œé‡Œæ‘æœ‰ç€ä¸°å¯Œçš„çº¢è‰²å†å²ï¼Œè¿™é‡Œæ›¾æ˜¯é©å‘½æ´»åŠ¨çš„é‡è¦åœ°ç‚¹ã€‚æ‚¨å¯ä»¥å‚è§‚é©å‘½å†å²çºªå¿µé¦†ï¼Œäº†è§£é©å‘½å…ˆçƒˆçš„è‹±å‹‡äº‹è¿¹ã€‚',
                    url: 'red-tour.html'
                },
                'ä¼´ä½ æ¸¸ä¸œé‡Œ': { 
                    content: 'ä¸œé‡Œæ‘é£æ™¯ç§€ä¸½ï¼Œæœ‰å¤æ¦•æ ‘ç¾¤ã€æ¸…æ°´æºªæµç­‰è‡ªç„¶æ™¯è§‚ã€‚æ¨èè·¯çº¿ï¼šæ‘å£â†’å¤æ¦•æ ‘ç¾¤â†’æ¸…æ°´æºªæµâ†’æ‘å²é¦†â†’çº¢è‰²æ•™è‚²åŸºåœ°ã€‚',
                    url: 'tour-guide.html'
                },
                'èµ°è¿›ä¸œé‡Œ': { 
                    content: 'ä¸œé‡Œæ‘å§‹å»ºäºæ˜æœï¼Œæœ‰ç€500å¤šå¹´çš„å†å²ã€‚æ‘ä¸­çš„å¤å»ºç­‘ã€ä¼ ç»Ÿæ‰‹å·¥è‰ºå’Œæ°‘ä¿—æ–‡åŒ–éƒ½ä½“ç°äº†æ·±åšçš„å†å²åº•è•´ã€‚',
                    url: 'village-intro.html'
                },
                'æ‘å­åŠ¨æ€': { 
                    content: 'æœ€æ–°æ¶ˆæ¯ï¼šä¸œé‡Œæ‘å³å°†ä¸¾åŠä¸€å¹´ä¸€åº¦çš„æ°‘ä¿—æ–‡åŒ–èŠ‚ï¼Œå±Šæ—¶å°†æœ‰ä¼ ç»Ÿè¡¨æ¼”ã€æ‰‹å·¥è‰ºå±•ç¤ºå’Œç¾é£ŸèŠ‚ç­‰æ´»åŠ¨ï¼Œæ¬¢è¿å‰æ¥å‚è§‚ä½“éªŒï¼',
                    url: 'news.html'
                }
            };
            
            const module = pageMap[moduleName] || { content: 'å†…å®¹åŠ è½½ä¸­...', url: 'index.html' };
            return `${module.content}<br><br><a href="${module.url}" class="text-emerald-600 hover:underline" style="font-size: 12px;">ã€ç‚¹å‡»æ­¤å¤„å¿«æ·è®¿é—®ã€‘</a>`;
        }

        // ç»‘å®šè¾“å…¥åŒºåŸŸäº‹ä»¶
        function bindInputEvents() {
            const input = document.getElementById('messageInput');
            const sendBtn = document.getElementById('sendBtn');
            
            const sendMessage = () => {
                const message = input.value.trim();
                if (message) {
                    addUserMessage(message);
                    input.value = '';
                    generateResponse(message);
                }
            };

            if (sendBtn) {
                sendBtn.addEventListener('click', sendMessage);
            }
            
            if (input) {
                input.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        sendMessage();
                    }
                });
            }
        }

        // æ·»åŠ ç”¨æˆ·æ¶ˆæ¯
        function addUserMessage(message) {
            const chatContent = document.getElementById('chatContent');
            if (!chatContent) return;
            
            const userMessage = document.createElement('div');
            userMessage.className = 'chat-bubble-user';
            userMessage.textContent = message;
            chatContent.appendChild(userMessage);
            chatContent.scrollTop = chatContent.scrollHeight;
        }

        // ç”Ÿæˆå›å¤
        function generateResponse(message) {
            setTimeout(() => {
                const chatContent = document.getElementById('chatContent');
                if (!chatContent) return;
                
                const response = document.createElement('div');
                response.className = 'chat-bubble-assistant';
                response.innerHTML = generateReplyContent(message);
                chatContent.appendChild(response);
                chatContent.scrollTop = chatContent.scrollHeight;
            }, 800);
        }

        // ç”Ÿæˆå›å¤å†…å®¹
        function generateReplyContent(message) {
            const responses = {
                'ä½ å¥½': 'æ‚¨å¥½ï¼æˆ‘æ˜¯Aå”æ‘å®˜ï¼Œå¾ˆé«˜å…´ä¸ºæ‚¨æœåŠ¡ï¼',
                'å†å²': 'ä¸œé‡Œæ‘æœ‰ç€æ‚ ä¹…çš„å†å²ï¼Œå§‹å»ºäºæ˜æœï¼Œæœ‰500å¤šå¹´çš„å†å²æ²‰æ·€ã€‚',
                'æ—…æ¸¸': 'ä¸œé‡Œæ‘æœ‰è®¸å¤šå€¼å¾—æ¸¸è§ˆçš„æ™¯ç‚¹ï¼ŒåŒ…æ‹¬å¤æ¦•æ ‘ç¾¤ã€æ¸…æ°´æºªæµç­‰è‡ªç„¶æ™¯è§‚ã€‚',
                'çº¢è‰²': 'ä¸œé‡Œæ‘æ˜¯é©å‘½è€åŒºï¼Œæœ‰ç€å…‰è£çš„é©å‘½ä¼ ç»Ÿå’Œä¸°å¯Œçš„çº¢è‰²èµ„æºã€‚',
                'åŠ¨æ€': 'æœ€æ–°æ¶ˆæ¯ï¼šä¸œé‡Œæ‘æ°‘ä¿—æ–‡åŒ–èŠ‚å³å°†å¼€å¹•ï¼Œæ¬¢è¿å‰æ¥ä½“éªŒä¼ ç»Ÿæ°‘ä¿—æ–‡åŒ–ï¼'
            };

            for (let key in responses) {
                if (message.includes(key)) {
                    return responses[key];
                }
            }

            return `æ„Ÿè°¢æ‚¨çš„æé—®ï¼å…³äº"${message}"ï¼Œæˆ‘å¯ä»¥ä¸ºæ‚¨æä¾›æ›´è¯¦ç»†çš„ä¿¡æ¯ï¼Œè¯·ç‚¹å‡»ä¸Šæ–¹çš„åŠŸèƒ½æ¨¡å—äº†è§£æ›´å¤šå†…å®¹ã€‚`;
        }
    </script>
</body>
</html>
